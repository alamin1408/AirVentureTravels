<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Airport Suggestion Demo</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen">

  <div class="relative w-full max-w-md">
    <label for="airportInput" class="block text-lg font-semibold mb-2">✈️ Choose Destination</label>
    <input id="airportInput" type="text" placeholder="Enter city or airport name"
           class="w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-blue-500 outline-none" />
    
    <!-- Suggestion box -->
    <ul id="suggestions" class="absolute z-10 bg-white border border-gray-300 w-full mt-1 rounded-lg shadow hidden"></ul>
  </div>

  <script>
    const apiKey = "b764df5d-f3af-4193-bc67-74b8ecc94b7f";
    const input = document.getElementById("airportInput");
    const suggestionBox = document.getElementById("suggestions");

    let timeout = null;

    input.addEventListener("input", () => {
      const query = input.value.trim();
      clearTimeout(timeout);

      if (query.length < 2) {
        suggestionBox.innerHTML = "";
        suggestionBox.classList.add("hidden");
        return;
      }

      timeout = setTimeout(async () => {
        try {
          const res = await fetch(`https://airlabs.co/api/v9/suggest?q=${query}&api_key=${apiKey}`);
          const data = await res.json();
          const airports = data.response?.airports || [];

          suggestionBox.innerHTML = "";
          if (airports.length === 0) {
            suggestionBox.classList.add("hidden");
            return;
          }

          airports.slice(0, 6).forEach(airport => {
            const li = document.createElement("li");
            li.className = "px-4 py-2 hover:bg-blue-100 cursor-pointer text-left";
            li.innerHTML = `
              <div class="flex items-center">
                <span class="text-blue-600 mr-2">✈️</span>
                <div>
                  <p class="font-semibold">${airport.name} (${airport.iata_code})</p>
                  <p class="text-sm text-gray-600">${airport.city_name || ""}, ${airport.country_name}</p>
                </div>
              </div>`;
            
            li.addEventListener("click", () => {
              input.value = `${airport.name} (${airport.iata_code})`;
              suggestionBox.classList.add("hidden");
            });

            suggestionBox.appendChild(li);
          });

          suggestionBox.classList.remove("hidden");
        } catch (err) {
          console.error("❌ Airport API Error:", err);
        }
      }, 300); // debounce
    });

    // hide suggestions when clicking outside
    document.addEventListener("click", (e) => {
      if (!e.target.closest("#airportInput") && !e.target.closest("#suggestions")) {
        suggestionBox.classList.add("hidden");
      }
    });
  </script>

</body>
</html>